Code for https://www.biorxiv.org/content/10.1101/2023.12.15.571838v1
